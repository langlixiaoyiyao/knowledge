## 基础知识
为了更好的理解字符串和base64字符串之间是如何进行转换的，我们需要了解一些基本的知识。   
### 何为ascii码
[ASCII码对照表](https://tool.oschina.net/commons?type=4)
ASCII码就是用一个字节（8位二进制）去表示一个字符。ASCII最大码值是127。
### 何为utf-8码
utf-8是一种可变长度编码格式，它可以用一个字节、两个字节、三个字节、四个字节去表示一个字符。   
0xxxxxxxx --> 0开头代表用一个字节去表示一个字符，后面的xxxxxxx就是这个字符的码数，码点起值： 0，码点终值：01111111（十进制为：127）。   
110xxxxx 10xxxxxx --> 110 开头代表用两个字节去表示一个字符，然后第二个字节固定是10，码点起值： 128，码点终值：11111 111111（十进制为：2047）。   
1110xxxx 10xxxxxx 10xxxxxx --> 1110 开头代表用三个字节去表示一个字符，然后第二个字节和第三个字节固定是10，码点起值： 2047，码点终值：1111 111111 111111（十进制为：65535）。 
### 何为utf-16
utf-16就是每个字符都是用两个字节表示。（js就是采用这种格式来存储字符）
## 字符串转换成base64
浏览器端可以通过btoa函数将**一个字节的字符组成的字符串**转换成base64
```
const str = '我是a';
const uint8_array = new TextEncoder().encode(str); // uint8Array [230, 136, 145, 230, 152, 175, 97]
// 将上一步得到的code转换成对应的一个字节表示的字符
const int_map_str = String.fromCharCode(...uint8_array); // 'æ\x88\x91æ\x98¯a'
// 利用btoa转换
const base64 = btoa(int_map_str); // 5oiR5pivYQ==
```
**问题1：new TextEncoder().encode(str); 是如何得到 uint8Array [230, 136, 145, 230, 152, 175, 97]**   
1、因为js的字符都是采用的utf-16格式去存储的，我们需要把它转换成一个字节构成的数组   
2、‘我’的码值是：25105, 换成二进制就是：01100010 00010001   
3、因为码值大于2047，所以在utf8编码中需要用三个字节表示，格式就是：1110xxxx 10xxxxxx 10xxxxxx,一共有10个x   
4、将二进制：01100010 00010001，按照上面的格式补充，得到：11100110 10001000 10010001   
5、将第三步得到的每8位二进制转换成10进制也就是：230 136 145   
6、以此类推，将得到的数据都集合到一个数组中就可以得到 uint8Array [230, 136, 145, 230, 152, 175, 97]   
## base64解码成普通字符串
```
const base64_str = '5oiR5pivYQ==';
const uint8_str = atob(base64_str); // 'æ\x88\x91æ\x98¯a'
const array = [...uint8_str].map(_v => _v.charCodeAt(0));
const uint8_array = new Uint8Array(array);
const source_str = new TextDecoder().decode(uint8_array);
```
**问题1：new TextDecoder().decode(uint8_array); 是怎么得到我是a的**   
1、通过 uint8Array [230, 136, 145, 230, 152, 175, 97]中得到的信息，数组的第一位是230   
2、之前说过utf8编码中，一个字节就可以表示的字符的码值会小于或等于127，两个字节表示的，那么数组的第一位会是大于 11000000 （十进制就是：192），三个字节表示的，那么数组第一位会大于 11100000 （十进制就是：224）   
3、很明显，第一位是230，大于224，所以是3个字节表示的，也就是 230 136 145都是表示第一个字符的。   
4、同理可得 230, 152, 175 是表示第二个字符的。   
5、97 小于127，97自己就可以表示一个字符   
